<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Tectonic Typesetting System</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A manual for the Tectonic typesetting system">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Overview</a></li><li class="chapter-item expanded "><a href="introduction/index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="getting-started/index.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-started/install.html"><strong aria-hidden="true">2.1.</strong> Install Tectonic</a></li><li class="chapter-item expanded "><a href="getting-started/first-document.html"><strong aria-hidden="true">2.2.</strong> Build Your First Document</a></li><li class="chapter-item expanded "><a href="getting-started/unicode.html"><strong aria-hidden="true">2.3.</strong> Use a Unicode Font</a></li></ol></li><li class="chapter-item expanded "><a href="lang-impl/index.html"><strong aria-hidden="true">3.</strong> The Tectonic Implementation of the TeX Language</a></li><li class="chapter-item expanded affix "><li class="part-title">“V2” Command-Line Interface</li><li class="chapter-item expanded "><a href="v2cli/build.html"><strong aria-hidden="true">4.</strong> tectonic -X build</a></li><li class="chapter-item expanded "><a href="v2cli/bundle.html"><strong aria-hidden="true">5.</strong> tectonic -X bundle</a></li><li class="chapter-item expanded "><a href="v2cli/compile.html"><strong aria-hidden="true">6.</strong> tectonic -X compile</a></li><li class="chapter-item expanded "><a href="v2cli/dump.html"><strong aria-hidden="true">7.</strong> tectonic -X dump</a></li><li class="chapter-item expanded "><a href="v2cli/init.html"><strong aria-hidden="true">8.</strong> tectonic -X init</a></li><li class="chapter-item expanded "><a href="v2cli/new.html"><strong aria-hidden="true">9.</strong> tectonic -X new</a></li><li class="chapter-item expanded "><a href="v2cli/show.html"><strong aria-hidden="true">10.</strong> tectonic -X show</a></li><li class="chapter-item expanded "><a href="v2cli/watch.html"><strong aria-hidden="true">11.</strong> tectonic -X watch</a></li><li class="chapter-item expanded affix "><li class="part-title">Concept Reference</li><li class="chapter-item expanded "><a href="ref/documents.html"><strong aria-hidden="true">12.</strong> Documents</a></li><li class="chapter-item expanded "><a href="ref/tectonic-toml.html"><strong aria-hidden="true">13.</strong> The Tectonic.toml File</a></li><li class="chapter-item expanded "><a href="ref/v1cli.html"><strong aria-hidden="true">14.</strong> “V1” Command-Line Interface</a></li><li class="chapter-item expanded "><a href="ref/v2cli.html"><strong aria-hidden="true">15.</strong> “V2” Command-Line Interface</a></li><li class="chapter-item expanded "><a href="ref/workspaces.html"><strong aria-hidden="true">16.</strong> Workspaces</a></li><li class="chapter-item expanded affix "><li class="part-title">How-To Guides</li><li class="chapter-item expanded "><a href="installation/index.html"><strong aria-hidden="true">17.</strong> Installing Tectonic</a></li><li class="chapter-item expanded "><a href="howto/build-tectonic/index.html"><strong aria-hidden="true">18.</strong> Building Tectonic</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="howto/build-tectonic/external-dep-install.html"><strong aria-hidden="true">18.1.</strong> Install Dependencies Externally</a></li><li class="chapter-item expanded "><a href="howto/build-tectonic/cargo-vcpkg-dep-install.html"><strong aria-hidden="true">18.2.</strong> Install Dependencies With cargo-vcpkg</a></li></ol></li><li class="chapter-item expanded "><a href="howto/auctex-setup/index.html"><strong aria-hidden="true">19.</strong> Use Tectonic with AucTeX</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Tectonic Typesetting System</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/tectonic-typesetting/tectonic" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#the-tectonic-typesetting-system" id="the-tectonic-typesetting-system">The Tectonic Typesetting System</a></h1>
<p>Tectonic is a modernized, complete, self-contained
<a href="https://en.wikipedia.org/wiki/TeX">TeX</a>/<a href="https://www.latex-project.org/">LaTeX</a>
engine, powered by <a href="http://xetex.sourceforge.net/">XeTeX</a> and
<a href="https://www.tug.org/texlive/">TeXLive</a>. This book aims to document the core
elements of the Tectonic software system.</p>
<p>Without further ado, we suggest you start with the <a href="./introduction/index.html">Introduction</a>!</p>
<h2><a class="header" href="#contributions-are-welcome" id="contributions-are-welcome">Contributions are welcome!</a></h2>
<p>This book is, clearly, a work in progress! Contributions of any kind are most
welcome — please see the discussion in
<a href="https://github.com/tectonic-typesetting/tectonic/issues/62">GitHub issue #62</a>
for some ideas of things that should be documented here.</p>
<p>The documentation is written in <a href="https://commonmark.org/">Markdown</a> (specifically, CommonMark using
<a href="https://crates.io/crates/pulldown-cmark">pulldown-cmark</a>) and rendered into HTML using <a href="https://rust-lang-nursery.github.io/mdBook/">mdbook</a>. The source code lives
in the <code>docs/</code> subdirectory of <a href="https://github.com/tectonic-typesetting/tectonic">the main tectonic repository</a>. To make and view
changes, all you need to do is <a href="https://github.com/rust-lang-nursery/mdBook#installation">install mdbook</a>, then run the command:</p>
<pre><code class="language-sh">$ mdbook serve
</code></pre>
<p>in the <code>docs/</code> directory.</p>
<p>Members of the Tectonic community are eager to help if you run into any issues —
please launch a discussion on <a href="https://github.com/tectonic-typesetting/tectonic/discussions">the Tectonic forum</a> if you’d like to get
involved!</p>
<h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<p>This book describes the Tectonic typesetting system. The goal of the Tectonic
project is to empower people to create beautiful, effective technical
documents.</p>
<h2><a class="header" href="#technical-documents" id="technical-documents">Technical documents</a></h2>
<p>What do we mean by “technical documents”? While the Tectonic project seeks to
cast its net as widely as possible, common examples might be software manuals,
scientific papers, or analytical reports. What features do such documents
include that traditional authoring frameworks have trouble supporting?</p>
<ul>
<li><strong>Mathematics</strong>. Any kind of mathematical typesetting is challenging.
<em>Beautiful</em> mathematical typesetting is <em>extremely hard</em> and requires deep
integration with the overall typesetting system.</li>
<li><strong>Abundant cross-references</strong>. Technical documents often involve extensive
internal and external cross-references (links), and managing such links is a
nightmare without extremely good tooling support.</li>
<li><strong>Rich content</strong>. Technical documents also generally include a great deal of
rich content beyond their text, such as figures, tables, and code. In the
best documents, this content is seamlessly integrated into the document
presentation, with precise author control over that presentation.</li>
<li><strong>Integrated computation</strong>. In the 21st century, it is finally possible to
integrate computation — runnable code samples, interactive graphics,
live-updating data, and so on — into documents, and it is becoming clear
that this new capability is not just evolutionary, but revolutionary.</li>
<li><strong>Hackability</strong>. Finally, we also believe that technical documents should
ideally be “hackable,” meaning that people should be able to see how they
work “under the hood” and use them as a basis for their own creations.</li>
</ul>
<h2><a class="header" href="#tectonic-and-tex" id="tectonic-and-tex">Tectonic and TeX</a></h2>
<p>At the core of Tectonic is a modernized, complete, self-contained
<a href="https://en.wikipedia.org/wiki/TeX">TeX</a>/<a href="https://www.latex-project.org/">LaTeX</a> engine, powered by <a href="http://xetex.sourceforge.net/">XeTeX</a> and <a href="https://www.tug.org/texlive/">TeXLive</a>.</p>
<p>For those new to it, <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> is a programming language. While most programming
languages create software, <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> creates typeset documents. <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> is quite
archaic in some ways, but in many fields it’s still the tool of choice for
authoring the kinds of documents described above.</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/TeX">TeX</a> is absolutely unparalleled in its ability to typeset math. Workers in
virtually every mathematics-heavy field use <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> to create documents.</li>
<li>The <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> ecosystem provides infrastructure for deep and rich
cross-referencing with programs like <a href="http://www.bibtex.org/">bibtex</a>.</li>
<li>Another hallmark of the <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> ecosystem is longstanding support for complex
figures, tables, and other forms of rich content included in the document.</li>
<li>Because <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> is a programming language for creating documents, <a href="https://en.wikipedia.org/wiki/TeX">TeX</a>-based
documents can be hackable in exactly the same way as the open-source
programs that underly so much of the modern software ecosystem.</li>
</ul>
<p>The fundamental principle underlying the Tectonic project is that <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> is,
and can continue to be, the best language out there for creating the
beautiful, effective technical documents that the world deserves. The <a href="https://en.wikipedia.org/wiki/TeX">TeX</a>
language is an amazingly clever piece of engineering, and the fact that it’s
still in use 40 years (!) after its creation speaks for itself. But by the
same token, there is a <em>lot</em> about the <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> software ecosystem that is
archaic and outdated. The goal of Tectonic is to build on the good stuff and
leave behind the things that don’t make sense anymore.</p>
<p>In particular, Tectonic is derived from the source code that powers the
<a href="http://xetex.sourceforge.net/">XeTeX</a> engine, and the bulk of its code is the same core engine that
implements the complex, Unicode-aware typesetting performed by <a href="http://xetex.sourceforge.net/">XeTeX</a>.
Tectonic provides both a new user experience around that engine, and several
key interventions that enable the engine to be used in fundamentally new ways.</p>
<h2><a class="header" href="#the-goals-of-tectonic" id="the-goals-of-tectonic">The goals of Tectonic</a></h2>
<p>As stated above, the overall goal of the Tectonic project is to enable people
to create beautiful, effective technical documents. In particular, there are
several elements of the existing <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> ecosystem that Tectonic aims to improve
upon:</p>
<ul>
<li><em>User experience</em>. Many aspects of the classic <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> user experience (UX)
are bizarre and unpleasant to modern users. In particular, its error
messages and diagnostic output can be utterly mystifying. Tectonic chooses
to break compatibility with classic <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> when doing so offers the chance to
improve the UX.</li>
<li><em>Embeddability</em>. The modern <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> software system consists of a suite of
interacting command-line programs modifying a complex tree of thousands of
support files. This makes it extremely unpleasant to embed the <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> engine
within other software systems, which prevents a whole host of exciting use
cases. Tectonic delivers its engine as a reusable software library and aims
to make that library easy to embed and reuse anywhere code can run.</li>
<li><em>Reproducibility</em>. For the same reasons that the classic <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> experience is
difficult to embed, it is difficult to guarantee reproducible document
builds. For many technical documents, reproducibility is a highly-respected
virtue if not an outright requirement. Tectonic aims to enable easy,
byte-for-byte reproducible builds.</li>
<li><em>Web output</em>. Modern displays and Web browsers are incredibly powerful,
versatile tools. One of the motivations for the founding of the Tectonic
project was the belief that current Web-based technical documents are
falling far short of what should be possible, and the belief that some
changes in the core <a href="https://en.wikipedia.org/wiki/TeX">TeX</a> engine are necessary to fully unlock its ability
to produce excellent Web-based output.</li>
</ul>
<h1><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h1>
<p>This chapter of the book will introduce you to Tectonic, with a special emphasis
on the ways that it’s different from the TeX systems that you might have seen
before. We’ll assume a very basic familiarity with TeX and LaTeX, and that you
know how to use a command-line interface on your computer.</p>
<p>The sections in this chapter are:</p>
<ol>
<li><a href="getting-started/./install.html">Install Tectonic</a></li>
<li><a href="getting-started/./first-document.html">Build your first document</a></li>
<li><a href="getting-started/./unicode.html">Use a Unicode font</a></li>
</ol>
<h1><a class="header" href="#getting-started-install-tectonic" id="getting-started-install-tectonic">Getting Started: Install Tectonic</a></h1>
<p>Let’s start out by making sure that Tectonic is installed on your system.</p>
<p>Even this step will be very different than what you might be used to with other
TeX systems. To install a normal TeX system such as <a href="https://www.tug.org/texlive/acquire-netinstall.html">TeXLive</a>, you normally need
to download gigabytes of support files and set them up in a complex directory
hierarchy. Tectonic, on the other hand, is distributed as a single executable
file. That one file not only combines the functionality of many standard TeX
programs, but it also can download the many necessary support files on the fly.
This makes Tectonic super easy to install.</p>
<p>The quickest way to get started is to use your terminal. On a computer running a
Unix-like operating system, including macOS, just run the following command in
your terminal:</p>
<pre><code class="language-sh">curl --proto '=https' --tlsv1.2 -fsSL https://drop-sh.fullyjustified.net |sh
</code></pre>
<p>This will download the <code>tectonic</code> program and place it into the directory where
you ran the command.</p>
<p>On Windows, copy-paste this into a PowerShell window, which will unpack
<code>tectonic.exe</code> for you:</p>
<pre><code class="language-ps1">[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://drop-ps1.fullyjustified.net'))
</code></pre>
<p>No matter your operating system, you should move the unpacked file into a
directory in your executable search path so that you can run Tectonic from any
working directory. For the time being, the download script doesn’t do this
because it can be tricky to automatically determine what the best installation
destination would be.</p>
<p>Alternatively, you can <a href="getting-started/../installation/index.html#pre-built-binary-packages">install a packaged version of Tectonic</a>
if one is available. For detailed instructions and additional installation
options, go to the <a href="getting-started/../installation/index.html">How To Install Tectonic</a> guide.</p>
<p>You’ll know that you’re set up when you can go to your computer’s command prompt
and run:</p>
<pre><code class="language-sh">$ tectonic --help
</code></pre>
<p>and the result is that you get a printout of information about different options
and arguments that you can pass to the Tectonic program. (From now on we’ll use
a convention of a leading <code>$</code> to indicate a command that you should run at your
computer’s command prompt. You don’t type the dollar sign itself.)</p>
<p>To be explicit, <em>Tectonic does not invoke an external <code>latex</code> program, and
Tectonic is not a “wrapper” for (La)TeX.</em> Tectonic <em>is</em> the LaTeX program. This
is essential. <a href="getting-started/../introduction/index.html#the-goals-of-tectonic">The goals of the Tectonic project</a> involve a fundamental
transformation of how we use TeX to create technical documents, and it is not
possible to achieve that without radical surgery to the heart of how TeX has
traditionally operated.</p>
<h1><a class="header" href="#getting-started-build-your-first-document" id="getting-started-build-your-first-document">Getting Started: Build Your First Document</a></h1>
<p>Now that <a href="getting-started/./install.html">you’ve installed Tectonic</a>, let’s create and build your first
<a href="getting-started/../ref/documents.html">document</a>.</p>
<p><strong>Important:</strong> <em>From here on out, this <a href="getting-started/./index.html">Getting Started</a> guide will
use what we call the <a href="getting-started/../ref/v2cli.html">“V2” interface</a> to the Tectonic program. The V2
interface coexists with, but has a fairly different approach than, the <a href="getting-started/../ref/v1cli.html">“V1”
interface</a>. We are gradually migrating from V1 to V2. Neither interface
(V1 or V2) is the same as the one exposed by classic TeX tools such as
<code>pdflatex</code>.</em></p>
<h2><a class="header" href="#create-a-new-document" id="create-a-new-document">Create a new document</a></h2>
<p>The Tectonic <a href="getting-started/../ref/v2cli.html">V2 interface</a> has a “multitool” structure similar to that
of other powerful tools such as <a href="https://git-scm.com/">git</a> and <a href="https://doc.rust-lang.org/cargo/">cargo</a>. To create a new document, we
use a <a href="getting-started/../v2cli/new.html"><code>new</code></a> subcommand that looks like this:</p>
<pre><code class="language-sh">$ tectonic -X new myfirstdoc
</code></pre>
<p>This will create a new <a href="getting-started/../ref/workspaces.html">Tectonic workspace</a> directory named
<code>myfirstdoc</code> containing a file <code>Tectonic.toml</code> and a sub-directory named <code>src</code>.
Enter this new directory in your command prompt.</p>
<pre><code class="language-sh">$ cd myfirstdoc
</code></pre>
<p><strong>Note:</strong> <em>The <code>-X</code> flag activates the V2 interface. Don’t forget it! Eventually
it will become unnecessary and you’ll just be able to write <code>tectonic new</code>, but
that changeover hasn’t happened yet.</em></p>
<p>If you’ve got an existing TeX file, you can process it in one-off fashion with:</p>
<pre><code class="language-sh">$ tectonic -X compile myfile.tex
</code></pre>
<p>See <a href="getting-started/../v2cli/compile.html">the <code>tectonic -X compile</code> documentation</a> for all of the options.</p>
<h2><a class="header" href="#basic-document-source-structure" id="basic-document-source-structure">Basic document source structure</a></h2>
<p>The source code to your document is stored in the <code>src</code> subdirectory of your new
document. Check it out:</p>
<pre><code class="language-sh">$ ls src
</code></pre>
<p>You’ll see three files that were created by the <a href="getting-started/../v2cli/new.html"><code>new</code></a> command:</p>
<ul>
<li><code>_preamble.tex</code></li>
<li><code>index.tex</code></li>
<li><code>_postamble.tex</code></li>
</ul>
<p>These files are pre-populated with extremely basic contents following this
suggested source structure:</p>
<ul>
<li>The “preamble” file should contain all of your (La)TeX initialization
boilerplate, up to and including the LaTeX <code>\begin{document}</code> command.</li>
<li>The “index” file contains all of your actual document content, without any of
the annoying boilerplate. When you create a new Tectonic document, it just
contains the text <code>Hello, world.</code></li>
<li>The “postamble” file should contain all of your cleanup code, starting with
the LaTeX <code>\end{document}</code> command. There will almost never need to be any
other content in this file.</li>
</ul>
<p>When Tectonic builds your document, it processes these files in the order listed
above, so all three of them need to be available. But the breakdown suggested
above is only a suggestion, nothing more. If you want all of your boilerplate
and content to be in a single file, we recommend putting it all in <code>index.tex</code>
and making your preamble and postamble empty.</p>
<p>The motivation for this separation is partially stylistic, but not entirely so.
In the future, we anticipate that there might be different ways to build the
same document that invoke different preamble or postamble contents.</p>
<h2><a class="header" href="#building-your-document" id="building-your-document">Building your document</a></h2>
<p>To compile your document, run:</p>
<pre><code class="language-sh">$ tectonic -X build
</code></pre>
<p>If you haven’t run Tectonic on your computer before, this command will take a
minute or two as it downloads the support files that it needs and generates the
LaTeX “format file” storing the default macro collection. Tectonic will <a href="getting-started/first-document.html#cache">cache</a>
these files and avoid downloading them again. Test it out by running the build
again:</p>
<pre><code class="language-sh">$ tectonic -X build
</code></pre>
<p>This time the command should finish much more quickly, with no messages about
downloading files. The output PDF document will be placed at the path
<code>build/default/default.pdf</code> relative to your document directory:</p>
<pre><code class="language-sh">$ ls -l build/default/
</code></pre>
<p>If you’re familiar with traditional TeX engines, you’ll have noticed that
Tectonic’s “user experience” is substantially different from those engines:</p>
<ol>
<li>Tectonic doesn’t print out the usual chatter — unless there’s an error.</li>
<li>Tectonic automatically reruns the TeX stage until its output stabilizes.</li>
<li>By default, Tectonic doesn’t write out intermediate files such as
(<code>texput.aux</code>, <code>texput.log</code>).</li>
<li>You ought not have seen this yet, but if you make a mistake in your TeX,
Tectonic will quit with an error message, rather than asking you to type <code>X2</code>
or whatever.</li>
</ol>
<p>We hope that you’ll agree that these changes make for a program that is much
more pleasant to use than the traditional tools.</p>
<h2><a class="header" href="#cache" id="cache">Cache</a></h2>
<p>The location of the cache depends on your operating system. You can use the
<a href="getting-started/../ref/v2cli.html">V2 Interface</a> to find the exact cache location on your machine
or take a look <a href="https://docs.rs/tectonic_io_base/latest/tectonic_io_base/app_dirs/fn.ensure_user_cache_dir.html">at the implementation</a>.</p>
<p>If you need to change the location of the cache, you can do that by setting
the environment variable <code>TECTONIC_CACHE_DIR</code> to the path of a directory.
We recommend leaving the cache location at the default unless there is a
compelling reason to change it.</p>
<h1><a class="header" href="#getting-started-use-a-unicode-font" id="getting-started-use-a-unicode-font">Getting Started: Use a Unicode Font</a></h1>
<p>You’ve <a href="getting-started/./first-document.html">created your first Tectonic document</a>. Great! Now, let’s
start exploring the ways in which Tectonic helps you create modern <a href="getting-started/../introduction/index.html#technical-documents">technical
documents</a>.</p>
<p>We’ve already seen a few ways that Tectonic differs from traditional TeX
engines. Perhaps the most fundamentally important difference, however, is the
one that we’ll explore in this section.</p>
<p><strong>Note:</strong> <em>This <a href="getting-started/./index.html">Getting Started</a> guide uses what we call the <a href="getting-started/../ref/v2cli.html">“V2”
interface</a> to the Tectonic command-line tool. The V2 interface coexists
with, but has a fairly different approach than, the <a href="getting-started/../ref/v1cli.html">“V1”interface</a>. We
are gradually migrating from V1 to V2. Neither interface (V1 or V2) is the same
as the one exposed by classic TeX tools such as <code>pdflatex</code>.</em></p>
<h2><a class="header" href="#unicode" id="unicode">Unicode</a></h2>
<p>When TeX was first developed <a href="https://en.wikipedia.org/wiki/TeX#History">more than 40 years ago</a>, digital
systems for representing human writing were pretty primitive. Because TeX needed
to represent a variety of languages <em>and</em> mathematics, it was endowed with
comparatively sophisticated tools to both accept and emit characters that aren’t
found in standard English. TeX’s good multi-lingual support was one of the
things that made it groundbreaking. Eventually, however, a consortium of major
technology companies developed the much more comprehensive <a href="https://home.unicode.org/">Unicode</a> standards
for representing the world’s writing systems digitally. By now, they’re
universally adopted. So while the TeX ecosystem started out ahead of the curve,
some of its core systems are designed around an incompatible and, frankly,
dead-end framework.</p>
<p>That is not to imply that the whole TeX universe is stuck in the past! Many
people have worked extremely hard to bridge the worlds of TeX and Unicode. The
code in Tectonic, in particular, is based on <a href="http://xetex.sourceforge.net/">XeTeX</a>, which adds Unicode support
to the classic TeX experience. Without the efforts of the <a href="http://xetex.sourceforge.net/">XeTeX</a> team and many
other dedicated volunteers in the TeX world, Tectonic wouldn’t be able to offer
Unicode support.</p>
<h2><a class="header" href="#modern-fonts" id="modern-fonts">Modern Fonts</a></h2>
<p>Tectonic’s support for Unicode allows it to take advantage of modern fonts that
are distributed using formats such as <a href="https://en.wikipedia.org/wiki/OpenType">OpenType</a>. Besides opening up access to a
whole world of typographic progress — a good font is the result of <em>years</em> of
expert effort — this support positions Tectonic to create outputs in not just
<a href="https://en.wikipedia.org/wiki/PDF">PDF</a> but <a href="https://en.wikipedia.org/wiki/HTML">HTML</a> formats. HTML capability is still under development, but it’s
one of the prime reasons that the Tectonic project was started.</p>
<p>The choice of fonts is foundational to TeX’s document processing, so modern
fonts aren’t automatically activated. To start using a nice new font like <a href="https://www.fontsquirrel.com/fonts/tex-gyre-pagella">TeX
Gyre Pagella</a> (derived from <a href="https://en.wikipedia.org/wiki/Palatino">Palatino</a>), open up your
<code>src/_preamble.tex</code> file and add the following lines after the <code>\documentclass</code>
command:</p>
<pre><code class="language-tex">\usepackage{fontspec}
\setmainfont{texgyrepagella}[
  Extension = .otf,
  UprightFont = *-regular,
  BoldFont = *-bold,
  ItalicFont = *-italic,
  BoldItalicFont = *-bolditalic,
]
</code></pre>
<p>Now rebuild your document:</p>
<pre><code class="language-sh">$ tectonic -X build
</code></pre>
<p>You’ll probably see Tectonic download some files: namely, the new font files
that you have started using. Tectonic’s ability to fetch such files on the fly
is why its installation is so much easier than a traditional TeX engine.</p>
<p>If you open up your rebuilt document, it will be using your new font, although
the difference can be difficult to detect with such a small amount of sample
text.</p>
<h2><a class="header" href="#unicode-input-text" id="unicode-input-text">Unicode Input Text</a></h2>
<p>Tectonic’s support for Unicode broadens its <em>output</em> capabilities through the
use of modern fonts. But that’s not all: Unicode also broadens the <em>inputs</em> 
that Tectonic accepts.</p>
<p>With Tectonic, you can type non-English characters directly into your input TeX
files, which are parsed assuming the virtually-universal <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8 Unicode text
encoding</a>. For instance, you can open up your <code>src/index.tex</code> file and
copy-paste in the following <a href="https://en.wikipedia.org/wiki/Le_Bateau_ivre">verse</a> with accented characters:</p>
<pre><code class="language-tex">Ô que ma quille éclate! Ô que j’aille à la mer!
</code></pre>
<p>Rebuild your document and see your new text in the output:</p>
<pre><code class="language-sh">$ tectonic -X build
</code></pre>
<p><em>Whatever</em>, you might say. <em>I know how to get these accented characters with TeX
commands:</em></p>
<pre><code class="language-tex">\^O que ma quille \'eclate! \^O que j'aille \`a la mer!
</code></pre>
<p>Fair enough. But now try typing in <a href="https://www.japantimes.co.jp/news/2019/10/19/national/history/frog-jump-bashos-pond/">Bashô’s “old pond” haiku</a>:</p>
<pre><code class="language-tex">古池や蛙飛び込む水の音
  ふるいけやかわずとびこむみずのおと
</code></pre>
<p>We’ll wait.</p>
<p>(Note, however, that if you copy-paste this text into our sample document, it
won’t work: you haven’t activated a font able to handle the Japanese characters.
You’ll get a lot of warnings to that effect.)</p>
<h1><a class="header" href="#the-tectonic-implementation-of-the-tex-language" id="the-tectonic-implementation-of-the-tex-language">The Tectonic Implementation of the TeX Language</a></h1>
<p>TODO: links to TeX language guides</p>
<p>TODO: document customizations, e.g. <code>\TectonicCodaTokens</code>.</p>
<h1><a class="header" href="#tectonic--x-build" id="tectonic--x-build">tectonic -X build</a></h1>
<p>Build the current document.</p>
<p><em><strong>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</strong></em></p>
<h4><a class="header" href="#usage-synopsis" id="usage-synopsis">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X build
  [--keep-intermediates] [-k]
  [--keep-logs]
  [--only-cached] [-C]
  [--open]
  [--print] [-p]
  [--target &lt;target&gt;]
  [--untrusted]
</code></pre>
<h4><a class="header" href="#remarks" id="remarks">Remarks</a></h4>
<p>This command builds the current document, as identified by searching for a
<a href="v2cli/../ref/tectonic-toml.html">Tectonic.toml</a> file in the current directory or one of its
parents. The build artifacts will be placed into the document’s build output
directory, which defaults to a subdirectory <code>build</code> of the document source
directory.</p>
<h4><a class="header" href="#command-line-options" id="command-line-options">Command-Line Options</a></h4>
<p>The <code>--keep-intermediates</code> option (or <code>-k</code> for short) will cause the engine to
save intermediate files (such as <code>mydoc.aux</code> or <code>mydoc.bbl</code>) in the build output
directory. By default, these files are stored in memory but not actually written
to disk.</p>
<p>The <code>--keep-logs</code> option will cause the engine to save the main TeX log file
(<code>mydoc.log</code>) to disk. By default, this information is discarded.</p>
<p>The <code>--only-cached</code> option (or <code>-C</code> for short) will configure the engine to
refuse to connect to the network when searching for support files. This can be
useful if you’re working on a document in a context where the Internet is
unavailable (e.g., on an airplane). While the engine generally avoids
unnecessary network connections, referencing a new file in your document will
cause it to look for that file in the online support bundle.</p>
<p>The <code>--open</code> option will open the built document using the system handler.</p>
<p>The <code>--print</code> option (or <code>-p</code> for short) will cause the engine to print the
regular terminal output of the TeX engine. This output is similar to, but not
identical to, the contents of the log file. By default, this output is only
printed if the engine encounters a fatal error.</p>
<p>The <code>--target</code> option will only build the
<a href="v2cli/../ref/tectonic-toml.html#output">output</a> with the specified name. If this option
is not given, all outputs will be built.</p>
<p>Use the <code>--untrusted</code> option if building untrusted content. This is not the
default, because in most cases you <em>will</em> trust the document that you’re
building, probably because you have created it yourself, and it would be very
annoying to have to pass <code>--trusted</code> every time you build a document that uses
shell-escape. See the security discussion in the documentation of the
<a href="v2cli/./compile.html">compile</a> command for details. In actual usage, it would obviously
be easy to forget to use this option; in cases where untrusted inputs are a
genuine concern, we recommend setting the environment variable
<code>TECTONIC_UNTRUSTED_MODE</code> to a non-empty value. This has the same effect as the
<code>--untrusted</code> option. Note, however, that a hostile shell user can trivially
clear this variable.</p>
<h1><a class="header" href="#tectonic--x-bundle" id="tectonic--x-bundle">tectonic -X bundle</a></h1>
<p>Commands relating to Tectonic’s “bundles” of support files.</p>
<p><em><strong>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</strong></em></p>
<p>The <code>bundle</code> subcommands are:</p>
<ul>
<li><a href="v2cli/bundle.html#tectonic--x-bundle-cat"><code>tectonic -X bundle cat</code></a></li>
<li><a href="v2cli/bundle.html#tectonic--x-bundle-search"><code>tectonic -X bundle search</code></a></li>
</ul>
<h2><a class="header" href="#tectonic--x-bundle-cat" id="tectonic--x-bundle-cat">tectonic -X bundle cat</a></h2>
<p>Print out a file stored in the current document’s backing bundle.</p>
<h4><a class="header" href="#usage-synopsis-1" id="usage-synopsis-1">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X bundle cat &lt;filename&gt;
</code></pre>
<h4><a class="header" href="#example" id="example">Example</a></h4>
<pre><code class="language-sh">$ tectonic -X bundle cat latex.ltx
%%
%% This is file `latex.ltx',
%% generated with the docstrip utility.
...
</code></pre>
<h4><a class="header" href="#remarks-1" id="remarks-1">Remarks</a></h4>
<p>If this command is run outside of a <a href="v2cli/../ref/workspaces.html">document workspace</a>,
the system default bundle will be used.</p>
<h2><a class="header" href="#tectonic--x-bundle-search" id="tectonic--x-bundle-search">tectonic -X bundle search</a></h2>
<p>Print out the names of files in the current document’s backing bundle,
potentially with filtering.</p>
<h4><a class="header" href="#usage-synopsis-2" id="usage-synopsis-2">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X bundle search [term]
</code></pre>
<h4><a class="header" href="#example-1" id="example-1">Example</a></h4>
<pre><code class="language-sh">$ tectonic -X bundle search minted
minted1.sty
tcbminted.code.tex
minted.4ht
minted.sty
</code></pre>
<h4><a class="header" href="#remarks-2" id="remarks-2">Remarks</a></h4>
<p>If no term is specified, <em>all</em> of the files in the bundle are printed. The
ordering of those filenames is unspecified.</p>
<p>The default search method is to use simple substring matching. Other methods may
be added in the future, activated by additional options.</p>
<p>If this command is run outside of a <a href="v2cli/../ref/workspaces.html">document workspace</a>,
the system default bundle will be used.</p>
<h1><a class="header" href="#tectonic--x-compile" id="tectonic--x-compile">tectonic -X compile</a></h1>
<p>Compile a standalone TeX document.</p>
<p><em><strong>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</strong></em></p>
<h4><a class="header" href="#example-2" id="example-2">Example</a></h4>
<p>Generate <code>myfile.pdf</code> from <code>myfile.tex</code>:</p>
<pre><code class="language-sh">tectonic -X compile myfile.tex
</code></pre>
<h4><a class="header" href="#usage-synopsis-3" id="usage-synopsis-3">Usage Synopsis</a></h4>
<!-- Keep options alphabetized -->
<pre><code class="language-sh">tectonic -X compile  # full form
  [--bundle &lt;file_path&gt;] [-b &lt;file_path&gt;]
  [--format &lt;path&gt;] [-f &lt;path&gt;]
  [--hide &lt;hide_path&gt;...]
  [--keep-intermediates] [-k]
  [--keep-logs]
  [--makefile-rules &lt;dest_path&gt;]
  [--only-cached] [-C]
  [--outdir &lt;outdir&gt;] [-o &lt;outdir&gt;]
  [--outfmt &lt;format&gt;]
  [--pass &lt;pass&gt;]
  [--print] [-p]
  [--reruns &lt;count&gt;] [-r &lt;count&gt;]
  [--synctex]
  [--untrusted]
  [--web-bundle &lt;url&gt;] [-w &lt;url&gt;]
  [-Z &lt;option&gt;...]
  &lt;input&gt;
</code></pre>
<h4><a class="header" href="#remarks-3" id="remarks-3">Remarks</a></h4>
<p>This command compiles a freestanding TeX document, outside of the Tectonic
<a href="v2cli/../ref/documents.html">document</a> framework. It is virtually the same interface as the <a href="v2cli/../ref/v1cli.html">“V1”
command-line interface</a>, with lots of options. In comparison, the V2
interface is “<a href="https://doc.rust-lang.org/cargo/">cargo</a>-like”, with a variety of subcommands anchored around a
<a href="v2cli/./tectonic-toml.html">Tectonic.toml</a> file defining a document to build.</p>
<p>Basic usage of this command is often as simple as:</p>
<pre><code class="language-sh">tectonic -X compile myfile.tex
</code></pre>
<p>This will compile the file and create <code>myfile.pdf</code> if nothing went wrong. You
can use an input filename of <code>-</code> to have Tectonic process standard input. (In
this case, the output file will be named <code>texput.pdf</code>.)</p>
<h5><a class="header" href="#security" id="security">Security</a></h5>
<p>By default, the document is compiled in a “trusted” mode. This means that the
calling user can request to enable certain engine features that could raise
security concerns if used with untrusted input: the classic example of this
being TeX’s “shell-escape” functionality. These features are <em>not</em> enabled by
default, but they can be enabled on the command line; in the case of
shell-escape, this is done with <code>-Z shell-escape</code>.</p>
<p>If the command-line argument <code>--untrusted</code> is provided, these features cannot be
enabled, regardless of other settings such as <code>-Z shell-escape</code>. So if you are
going to process untrusted input in a command-line script, as long as you make
sure that <code>--untrusted</code> is provided, the known-dangerous features will be
disabled.</p>
<p>Furthermore, if the environment variable <code>TECTONIC_UNTRUSTED_MODE</code> is set to a
non-empty value, Tectonic will behave as if <code>--untrusted</code> were specified,
regardless of the actual command-line arguments. Setting this variable can
provide a modest extra layer of protection if the Tectonic engine is being run
outside of its CLI form. Keep in mind that untrusted shell scripts and the like
can trivially defeat this by explicitly clearing the environment variable.</p>
<h4><a class="header" href="#options" id="options">Options</a></h4>
<p>The following are the available flags.</p>
<!-- Keep alphabetized by full name: -->
<table><thead><tr><th align="left">Short</th><th align="left">Full</th><th align="left">Explanation</th></tr></thead><tbody>
<tr><td align="left"><code>-b</code></td><td align="left"><code>--bundle &lt;file_path&gt;</code></td><td align="left">Use this directory or Zip-format bundle file to find resource files instead of the default</td></tr>
<tr><td align="left"><code>-f</code></td><td align="left"><code>--format &lt;path&gt;</code></td><td align="left">The name of the “format” file used to initialize the TeX engine [default: <code>latex</code>]</td></tr>
<tr><td align="left"><code>-h</code></td><td align="left"><code>--help</code></td><td align="left">Prints help information</td></tr>
<tr><td align="left"></td><td align="left"><code>--hide &lt;hide_path&gt;...</code></td><td align="left">Tell the engine that no file at <code>&lt;hide_path&gt;</code> exists, if it tries to read it</td></tr>
<tr><td align="left"><code>-k</code></td><td align="left"><code>--keep-intermediates</code></td><td align="left">Keep the intermediate files generated during processing</td></tr>
<tr><td align="left"></td><td align="left"><code>--keep-logs</code></td><td align="left">Keep the log files generated during processing</td></tr>
<tr><td align="left"></td><td align="left"><code>--makefile-rules &lt;dest_path&gt;</code></td><td align="left">Write Makefile-format rules expressing the dependencies of this run to <code>&lt;dest_path&gt;</code></td></tr>
<tr><td align="left"><code>-C</code></td><td align="left"><code>--only-cached</code></td><td align="left">Use only resource files cached locally</td></tr>
<tr><td align="left"><code>-o</code></td><td align="left"><code>--outdir &lt;outdir&gt;</code></td><td align="left">The directory in which to place output files [default: the directory containing <code>&lt;input&gt;</code>]</td></tr>
<tr><td align="left"></td><td align="left"><code>--outfmt &lt;format&gt;</code></td><td align="left">The kind of output to generate [default: <code>pdf</code>]  [possible values: <code>pdf</code>, <code>html</code>, <code>xdv</code>, <code>aux</code>, <code>fmt</code>]</td></tr>
<tr><td align="left"></td><td align="left"><code>--pass &lt;pass&gt;</code></td><td align="left">Which engines to run [default: <code>default</code>]  [possible values: <code>default</code>, <code>tex</code>, <code>bibtex_first</code>]</td></tr>
<tr><td align="left"><code>-p</code></td><td align="left"><code>--print</code></td><td align="left">Print the engine’s chatter during processing</td></tr>
<tr><td align="left"><code>-r</code></td><td align="left"><code>--reruns &lt;count&gt;</code></td><td align="left">Rerun the TeX engine exactly this many times after the first</td></tr>
<tr><td align="left"></td><td align="left"><code>--synctex</code></td><td align="left">Generate SyncTeX data</td></tr>
<tr><td align="left"></td><td align="left"><code>--untrusted</code></td><td align="left">Input is untrusted — disable all known-insecure features</td></tr>
<tr><td align="left"><code>-V</code></td><td align="left"><code>--version</code></td><td align="left">Prints version information</td></tr>
<tr><td align="left"><code>-w</code></td><td align="left"><code>--web-bundle &lt;url&gt;</code></td><td align="left">Use this URL to find resource files instead of the default</td></tr>
<tr><td align="left"><code>-Z</code></td><td align="left"><code>-Z &lt;option&gt;...</code></td><td align="left">Unstable options. Pass <code>-Zhelp</code> to show a list</td></tr>
</tbody></table>
<h4><a class="header" href="#unstable-options" id="unstable-options">Unstable options</a></h4>
<p>The following unstable options may be available. As the name aims to indicate,
the set of unstable options is subject to change at any time.</p>
<!-- Keep alphabetized: -->
<table><thead><tr><th align="left">Expression</th><th align="left">Explanation</th></tr></thead><tbody>
<tr><td align="left"><code>-Z help</code></td><td align="left">List all unstable options</td></tr>
<tr><td align="left"><code>-Z continue-on-errors</code></td><td align="left">Keep compiling even when severe errors occur</td></tr>
<tr><td align="left"><code>-Z min-crossrefs=&lt;num&gt;</code></td><td align="left">Equivalent to bibtex’s <code>-min-crossrefs</code> flag - “include after <code>&lt;num&gt;</code> crossrefs” [default: <code>2</code>]</td></tr>
<tr><td align="left"><code>-Z paper-size=&lt;spec&gt;</code></td><td align="left">Change the initial paper size [default: <code>letter</code>]</td></tr>
<tr><td align="left"><code>-Z search-path=&lt;path&gt;</code></td><td align="left">Also look in <code>&lt;path&gt;</code> for files (unless <code>--untrusted</code> has been specified), like <code>TEXINPUTS</code>. Can be specified multiple times.</td></tr>
<tr><td align="left"><code>-Z shell-escape</code></td><td align="left">Enable <code>\write18</code> (unless <code>--untrusted</code> has been specified)</td></tr>
<tr><td align="left"><code>-Z shell-escape-cwd=&lt;path&gt;</code></td><td align="left">Working directory to use for <code>\write18</code>. Use <code>$(pwd)</code> for same behaviour as most other engines (e.g. for relative paths in <code>\inputminted</code>). Implies <code>-Z shell-escape</code></td></tr>
<tr><td align="left"><code>-Z deterministic-mode</code></td><td align="left">Force a deterministic build environment. Note that setting <code>SOURCE_DATE_EPOCH</code> is usually sufficient for reproducible builds, and this option makes some extra functionality trade-offs. Specifically, deterministic mode breaks SyncTeX’s auxiliary files as they include and rely on absolute file paths</td></tr>
</tbody></table>
<h1><a class="header" href="#tectonic--x-dump" id="tectonic--x-dump">tectonic -X dump</a></h1>
<p>Run a partial document build and dump the contents of a TeX intermediate file to
standard output. This can be useful if you have an external tool that parses
such files, and you wish to integrate it into Tectonic-based authoring
workflows.</p>
<p><em><strong>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</strong></em></p>
<h4><a class="header" href="#example-3" id="example-3">Example</a></h4>
<p>Generate and print the LaTeX <code>aux</code> file for the current document:</p>
<pre><code class="language-sh">tectonic -X dump -s aux
</code></pre>
<p>This output can, for example, be piped into <a href="https://github.com/pkgw/bibtools/">bibtools</a> to generate a <code>.bib</code> file
that provides exactly the records needed for the document build.</p>
<h4><a class="header" href="#usage-synopsis-4" id="usage-synopsis-4">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X dump
  [--only-cached] [-C]
  [--profile &lt;profile&gt;] [-p &lt;profile&gt;]
  [--suffix] [-s]
  [--untrusted]
  &lt;filename&gt;
</code></pre>
<h4><a class="header" href="#remarks-4" id="remarks-4">Remarks</a></h4>
<p>This command runs a partial build of the current document, as identified by
searching for a <a href="v2cli/../ref/tectonic-toml.html">Tectonic.toml</a> file in the current directory or
one of its parents.</p>
<p>The “partial build” consists of one pass of the TeX engine. Future versions of
this tool might gain options allowing you to specify different passes. This
command can be used to dump any file created by TeX during the build (so long
as it’s created on the first pass).</p>
<h4><a class="header" href="#command-line-options-1" id="command-line-options-1">Command-Line Options</a></h4>
<p>The <code>--only-cached</code> option (or <code>-C</code> for short) will configure the engine to
refuse to connect to the network when searching for support files. This can be
useful if you’re working on a document in a context where the Internet is
unavailable (e.g., on an airplane). While the engine generally avoids
unnecessary network connections, referencing a new file in your document will
cause it to look for that file in the online support bundle.</p>
<p>The <code>--profile</code> option (or <code>-p</code> for short) will select which document output
profile will be used for the build. If unspecified, the profile to use will be
effectively chosen at random.</p>
<p>If the <code>--suffix</code> (<code>-s</code>) argument is provided, the name of the dumped file
simply has to <em>end</em> with the content of the argument <code>&lt;filename&gt;</code>, rather than
match it exactly. Therefore <code>tectonic -X dump -s aux</code> will dump the LaTeX <code>aux</code>
file regardless of its complete name, and <code>tectonic -X dump -s log</code> will dump
the log file. If there happens to be more than one file whose name ends with
your specified suffix, they will <em>all</em> be dumped, in a pseudo-random order.</p>
<p>Use the <code>--untrusted</code> option if working with untrusted content. This is not the
default, because in most cases you <em>will</em> trust the document that you’re
building, probably because you have created it yourself, and it would be very
annoying to have to pass <code>--trusted</code> every time you dump a document that uses
shell-escape. See the security discussion in the documentation of the
<a href="v2cli/./compile.html">compile</a> command for details. In actual usage, it would obviously
be easy to forget to use this option; in cases where untrusted inputs are a
genuine concern, we recommend setting the environment variable
<code>TECTONIC_UNTRUSTED_MODE</code> to a non-empty value. This has the same effect as the
<code>--untrusted</code> option. Note, however, that a hostile shell user can trivially
clear this variable.</p>
<h1><a class="header" href="#tectonic--x-init" id="tectonic--x-init">tectonic -X init</a></h1>
<p>Initializes a new Tectonic workspace in the current directory.</p>
<p><strong><em>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</em></strong></p>
<h4><a class="header" href="#usage-synopsis-5" id="usage-synopsis-5">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X init
</code></pre>
<h4><a class="header" href="#remarks-5" id="remarks-5">Remarks</a></h4>
<p>This command will create a bare-bones <a href="v2cli/../ref/tectonic-toml.html">Tectonic.toml</a> file in the
target directory. The project’s name will be initialized to the name of the
workspace directory.</p>
<p>It will also create placeholder source files in a <code>src</code> subdirectory:
<code>index.tex</code>, <code>_preamble.tex</code>, and <code>_postamble.tex</code>. The default build command
will process these files in the expected order:</p>
<ol>
<li><code>src/_preamble.tex</code></li>
<li><code>src/index.tex</code></li>
<li><code>src/_postamble.tex</code></li>
</ol>
<p>The intention of this framework is to allow you to isolate the main content of
your document from the usual LaTeX boilerplate. There are no restrictions on
what kind of content may be placed in each file, though.</p>
<h4><a class="header" href="#see-also" id="see-also">See Also</a></h4>
<ul>
<li><a href="v2cli/./new.html"><code>tectonic -X new</code></a></li>
</ul>
<h1><a class="header" href="#tectonic--x-new" id="tectonic--x-new">tectonic -X new</a></h1>
<p>Create a new Tectonic workspace.</p>
<p><strong><em>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</em></strong></p>
<h4><a class="header" href="#usage-synopsis-6" id="usage-synopsis-6">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X new [path]
</code></pre>
<p>If <code>[path]</code> is unspecified, the workspace is created in the current directory.</p>
<h4><a class="header" href="#remarks-6" id="remarks-6">Remarks</a></h4>
<p>This command will create a bare-bones <a href="v2cli/../ref/tectonic-toml.html">Tectonic.toml</a> file in the
target directory. The project’s name will be initialized to the name of the
workspace directory.</p>
<p>It will also create placeholder source files in a <code>src</code> subdirectory:
<code>index.tex</code>, <code>_preamble.tex</code>, and <code>_postamble.tex</code>. The default build command
will process these files in the expected order:</p>
<ol>
<li><code>src/_preamble.tex</code></li>
<li><code>src/index.tex</code></li>
<li><code>src/_postamble.tex</code></li>
</ol>
<p>The intention of this framework is to allow you to isolate the main content of
your document from the usual LaTeX boilerplate. There are no restrictions on
what kind of content may be placed in each file, though.</p>
<h4><a class="header" href="#see-also-1" id="see-also-1">See Also</a></h4>
<ul>
<li><a href="v2cli/./init.html"><code>tectonic -X init</code></a></li>
</ul>
<h1><a class="header" href="#tectonic--x-show" id="tectonic--x-show">tectonic -X show</a></h1>
<h1><a class="header" href="#tectonic--x-watch" id="tectonic--x-watch">tectonic -X watch</a></h1>
<p>Build the current document and rebuild it as input files change.</p>
<p><em><strong>This is a <a href="v2cli/../ref/v2cli.html">V2 CLI</a> command. For information on the original (“V1”
CLI), see <a href="v2cli/../ref/v1cli.html">its reference page</a>.</strong></em></p>
<h4><a class="header" href="#usage-synopsis-7" id="usage-synopsis-7">Usage Synopsis</a></h4>
<pre><code class="language-sh">tectonic -X watch
  [--exec &lt;execute&gt;...] [-x &lt;execute&gt;...]
</code></pre>
<h4><a class="header" href="#remarks-7" id="remarks-7">Remarks</a></h4>
<p>This command builds the current document in the same fashion as <a href="v2cli/./build.html"><code>tectonic -X build</code></a>, and then stays running and watches for changes to the input
files. It rebuilds the document when changes are detected.</p>
<h4><a class="header" href="#command-line-options-2" id="command-line-options-2">Command-Line Options</a></h4>
<p>The <code>--exec</code> option (or <code>-x</code> for short) configures the command used to run the
document build. The value of this option is appended to <code>tectonic -X</code> and
defaults to <code>build</code>. If you want to pass options to the build command, this is
the way to do so.</p>
<h1><a class="header" href="#documents" id="documents">Documents</a></h1>
<p><em><strong>This concept only applies to Tectonic’s <a href="ref/./v2cli.html">V2 interface</a>. It is not
relevant to <a href="ref/./v1cli.html">the original (“V1”) interface</a>.</strong></em></p>
<p>The fundamental unit of processing in Tectonic is the <em>document</em>. The main
purpose of Tectonic is to compile documents from their TeX source to one or more
output formats.</p>
<h2><a class="header" href="#source-structure" id="source-structure">Source structure</a></h2>
<p>Every Tectonic document is defined by a <a href="ref/./tectonic-toml.html">Tectonic.toml</a> file,
which is found at the root of its source tree. This directory is also the root
of the current Tectonic <a href="ref/./workspaces.html">workspace</a>. At the moment, “workspaces” and “documents”
are the same thing, but in the future it might become possible to define
multiple documents inside a single workspace.</p>
<p>The TeX sources are stored in a <code>src</code> subdirectory of the document root. This
directory should contain at least three files: <code>index.tex</code>, <code>_preamble.tex</code>,
and <code>_postamble.tex</code>. These filenames can be changed in the
<a href="ref/./tectonic-toml.html">Tectonic.toml</a> configuration file. The <a href="ref/../v2cli/build.html"><code>build</code>
command</a> will process these files in the following order:</p>
<ol>
<li><code>src/_preamble.tex</code></li>
<li><code>src/index.tex</code></li>
<li><code>src/_postamble.tex</code></li>
</ol>
<p>The intention of this framework is to allow you to isolate the main content of
your document from the usual LaTeX boilerplate. There are no restrictions on
what kind of content may be placed in each file, though. The preamble and
postamble can be empty if you’d like. The <a href="ref/../v2cli/new.html"><code>new</code> command</a> will stub out
these files for you.</p>
<h2><a class="header" href="#build-structure" id="build-structure">Build structure</a></h2>
<p>Build outputs are placed in the document’s build directory. By default, this is
a <code>build</code> subdirectory of the document root.</p>
<h1><a class="header" href="#the-tectonictoml-file" id="the-tectonictoml-file">The <code>Tectonic.toml</code> File</a></h1>
<p><strong>Starting with <a href="ref/./v2cli.html">the V2 interface</a></strong>, the <code>Tectonic.toml</code> file defines a
Tectonic document.</p>
<h2><a class="header" href="#contents" id="contents">Contents</a></h2>
<p>The <code>Tectonic.toml</code> file is expressed in, yes, <a href="https://toml.io/">TOML</a> format. Allowed items in
the file are detailed below.</p>
<pre><code class="language-toml">[doc]
name = &lt;string&gt;  # the document name
bundle = &lt;url or filesystem path&gt;  # the source of the TeX bundle

# The doc.metadata table may contain arbitrary data.
# It does not affect Tectonic in any way.
[doc.metadata]
pubish = false
arr = [1, 2, [6, 7]]



[[output]]  # one or more output specifications
name = &lt;string&gt;  # the output's name
type = &lt;&quot;pdf&quot;&gt;  # the output's type
tex_format = [string]  # optional, defaults to &quot;latex&quot;: the TeX format to use
shell_escape = [bool]  # optional, defaults to false: whether &quot;shell escape&quot; (\write18) is allowed
shell_escape_cwd = [string]  # optional, defaults to a temporary directory: path to use for \write18
preamble = [string] # optional, defaults to &quot;_preamble.tex&quot;: the preamble file to use (within `src`)
index = [string] # optional, defaults to &quot;index.tex&quot;: the index file to use (within `src`)
postamble = [string] # optional, defaults to &quot;_postamble.tex&quot;: the postamble file to use (within `src`)
</code></pre>
<p>Unexpected items are not allowed.</p>
<h2><a class="header" href="#items" id="items">Items</a></h2>
<h3><a class="header" href="#docname" id="docname"><code>doc.name</code></a></h3>
<p>The name of the document. This is distinct from the document title. This value
will be used to name output files, so it should be relatively short and
filesystem-friendly.</p>
<h3><a class="header" href="#docbundle" id="docbundle"><code>doc.bundle</code></a></h3>
<p>A string identifying the location of the “bundle” of TeX support files
underlying the processing of the document.</p>
<p>In most circumstances this value should be a URL. The <code>tectonic -X new</code> command
will populate this field with the current recommended default.</p>
<p>This field can also be a filesystem path, pointing to either a Zip-format bundle
or a directory of support files. This mode of operation is discouraged because
it limits reproducibility. URLs with a <code>file:</code> protocol are also treated
identically to filesystem paths.</p>
<h3><a class="header" href="#docmetadata" id="docmetadata"><code>doc.metadata</code></a></h3>
<p>Arbitrary metadata, not read by Tectonic. This table allows us to
save parameters for external scripts without creating an extra file.</p>
<h3><a class="header" href="#output" id="output"><code>output</code></a></h3>
<p>A list of dictionaries defining different outputs to be created from the
document source.</p>
<h3><a class="header" href="#outputname" id="outputname"><code>output.name</code></a></h3>
<p>A name given to the output. By default, build products for each output will be
placed in the build directory, in a subdirectory with this name.</p>
<h3><a class="header" href="#outputtype" id="outputtype"><code>output.type</code></a></h3>
<p>The kind of output to create. Currently, the only allowed option is <code>&quot;pdf&quot;</code>,
which creates a <a href="https://en.wikipedia.org/wiki/PDF">Portable Document Format</a> file.</p>
<h3><a class="header" href="#outputtex_format" id="outputtex_format"><code>output.tex_format</code></a></h3>
<p>The TeX “format” of preloaded macros to use when compiling the document. The
default is <code>&quot;latex&quot;</code>, corresponding to the standard LaTeX format. The exact set
of formats that are supported will depend on the bundle that is being used.</p>
<h3><a class="header" href="#outputshell_escape" id="outputshell_escape"><code>output.shell_escape</code></a></h3>
<p>Whether the TeX “shell escape”, AKA <code>\write18</code>, mechanism is allowed. The
default is false. Shell-escape is inherently insecure, because its usage
requires that text from the document compilation is passed directly to the
operating system shell. It also is inherently unportable, because it requires
that your document compilation is run in an environment where an operating
system shell exists and can be invoked. Its use is therefore strongly
discouraged, but some packages require it.</p>
<h3><a class="header" href="#outputshell_escape_cwd" id="outputshell_escape_cwd"><code>output.shell_escape_cwd</code></a></h3>
<p>The working directory path to use for “shell escape”. The default is a
temporary directory if <code>output.shell_escape</code> is true, else it's disabled.
The path can be absolute or relative to the root file, but it must exist.
Specifying this path automatically sets <code>output.shell_escape</code> to true.</p>
<h3><a class="header" href="#outputpreamble" id="outputpreamble"><code>output.preamble</code></a></h3>
<p>The preamble file to build the document with for this output. This defaults to
<code>&quot;_preamble.tex&quot;</code> within the <code>src</code> directory. Typically this file will contain
document setup steps.</p>
<h3><a class="header" href="#outputindex" id="outputindex"><code>output.index</code></a></h3>
<p>The index file to build the document with for this output. This defaults to
<code>&quot;index.tex&quot;</code> within the <code>src</code> directory. Typically this file will contain
the body of the document.</p>
<h3><a class="header" href="#outputpostamble" id="outputpostamble"><code>output.postamble</code></a></h3>
<p>The postamble file to build the document with for this output. This defaults to
<code>&quot;_postamble.tex&quot;</code> within the <code>src</code> directory. Typically this file will contain
document closing steps.</p>
<h1><a class="header" href="#v1-default-command-line-interface" id="v1-default-command-line-interface">“V1” (Default) Command Line Interface</a></h1>
<p>Tectonic is distributed as a single executable, <code>tectonic</code>, that is meant to be
invoked from the command line. We’re starting to refer to this program’s
command-line interface as the “V1” interface, because a new <a href="ref/./v2cli.html">“V2”
interface</a> is currently under development.</p>
<p>The V1 interface is “<a href="https://doc.rust-lang.org/rustc/command-line-arguments.html">rustc</a>-like”, offering a single primary workflow with lots
of options controlling its behavior. In comparison, the V2 interface is
“<a href="https://doc.rust-lang.org/cargo/">cargo</a>-like”, with a variety of subcommands anchored around a <a href="ref/./tectonic-toml.html">Tectonic.toml</a>
file defining a document to build.</p>
<h2><a class="header" href="#current-status" id="current-status">Current status</a></h2>
<p><strong>The V1 interface is the default</strong>. If you want to use the V2 interface, you
need to take special steps, as described in <a href="ref/./v2cli.html">its documentation</a>.</p>
<h2><a class="header" href="#basic-usage" id="basic-usage">Basic usage</a></h2>
<p>The V1 interface takes an input TeX file and compiles it. Basic usage is often
as simple as:</p>
<pre><code class="language-sh">tectonic myfile.tex
</code></pre>
<p>This will compile the file and create <code>myfile.pdf</code> if nothing went wrong. You
can use an input filename of <code>-</code> to have Tectonic process standard input. (In
this case, the output file will be named <code>texput.pdf</code>.)</p>
<h2><a class="header" href="#options-1" id="options-1">Options</a></h2>
<p>In the V1 interface there are a variety of options that control the engine’s
behavior. If you have Tectonic installed, you can view them with <code>tectonic --help</code>.</p>
<p>The following are the available flags.</p>
<table><thead><tr><th align="left">Short</th><th align="left">Full</th><th align="left">Explanation</th></tr></thead><tbody>
<tr><td align="left"><code>-b</code></td><td align="left"><code>--bundle &lt;file_path&gt;</code></td><td align="left">Use this directory or Zip-format bundle file to find resource files instead of the default</td></tr>
<tr><td align="left"><code>-c</code></td><td align="left"><code>--chatter &lt;level&gt;</code></td><td align="left">How much chatter to print when running [default: <code>default</code>]  [possible values: <code>default</code>, <code>minimal</code>]</td></tr>
<tr><td align="left"></td><td align="left"><code>--color &lt;when&gt;</code></td><td align="left">Enable/disable colorful log output [default: <code>auto</code>]  [possible values: <code>always</code>, <code>auto</code>, <code>never</code>]</td></tr>
<tr><td align="left"><code>-f</code></td><td align="left"><code>--format &lt;path&gt;</code></td><td align="left">The name of the “format” file used to initialize the TeX engine [default: <code>latex</code>]</td></tr>
<tr><td align="left"><code>-h</code></td><td align="left"><code>--help</code></td><td align="left">Prints help information</td></tr>
<tr><td align="left"></td><td align="left"><code>--hide &lt;hide_path&gt;...</code></td><td align="left">Tell the engine that no file at <code>&lt;hide_path&gt;</code> exists, if it tries to read it</td></tr>
<tr><td align="left"><code>-k</code></td><td align="left"><code>--keep-intermediates</code></td><td align="left">Keep the intermediate files generated during processing</td></tr>
<tr><td align="left"></td><td align="left"><code>--keep-logs</code></td><td align="left">Keep the log files generated during processing</td></tr>
<tr><td align="left"></td><td align="left"><code>--makefile-rules &lt;dest_path&gt;</code></td><td align="left">Write Makefile-format rules expressing the dependencies of this run to <code>&lt;dest_path&gt;</code></td></tr>
<tr><td align="left"><code>-C</code></td><td align="left"><code>--only-cached</code></td><td align="left">Use only resource files cached locally</td></tr>
<tr><td align="left"><code>-o</code></td><td align="left"><code>--outdir &lt;outdir&gt;</code></td><td align="left">The directory in which to place output files [default: the directory containing <code>&lt;input&gt;</code>]</td></tr>
<tr><td align="left"></td><td align="left"><code>--outfmt &lt;format&gt;</code></td><td align="left">The kind of output to generate [default: <code>pdf</code>]  [possible values: <code>pdf</code>, <code>html</code>, <code>xdv</code>, <code>aux</code>, <code>fmt</code>]</td></tr>
<tr><td align="left"></td><td align="left"><code>--pass &lt;pass&gt;</code></td><td align="left">Which engines to run [default: <code>default</code>]  [possible values: <code>default</code>, <code>tex</code>, <code>bibtex_first</code>]</td></tr>
<tr><td align="left"><code>-p</code></td><td align="left"><code>--print</code></td><td align="left">Print the engine’s chatter during processing</td></tr>
<tr><td align="left"><code>-r</code></td><td align="left"><code>--reruns &lt;count&gt;</code></td><td align="left">Rerun the TeX engine exactly this many times after the first</td></tr>
<tr><td align="left"></td><td align="left"><code>--synctex</code></td><td align="left">Generate SyncTeX data</td></tr>
<tr><td align="left"></td><td align="left"><code>--untrusted</code></td><td align="left">Input is untrusted — disable all known-insecure features</td></tr>
<tr><td align="left"><code>-V</code></td><td align="left"><code>--version</code></td><td align="left">Prints version information</td></tr>
<tr><td align="left"><code>-w</code></td><td align="left"><code>--web-bundle &lt;url&gt;</code></td><td align="left">Use this URL to find resource files instead of the default</td></tr>
<tr><td align="left"><code>-Z</code></td><td align="left"><code>-Z &lt;option&gt;...</code></td><td align="left">Unstable options. Pass <code>-Zhelp</code> to show a list</td></tr>
</tbody></table>
<h1><a class="header" href="#v2-prototype-command-line-interface" id="v2-prototype-command-line-interface">“V2” (Prototype) Command-Line Interface</a></h1>
<p>The “V2” command-line interface to Tectonic is a substantially new interface to
the Tectonic engine introduced in the 0.4.x release series.</p>
<p>In short, the V2 interface is “<a href="https://doc.rust-lang.org/cargo/">cargo</a>-like”, with a variety of subcommands
anchored around a <a href="ref/./tectonic-toml.html">Tectonic.toml</a> file defining a document to build. For
comparison, the original (“V1”) interface is more “<a href="https://doc.rust-lang.org/rustc/command-line-arguments.html">rustc</a>-like”, offering a
single primary workflow with lots of options controlling its behavior.</p>
<h2><a class="header" href="#current-status-1" id="current-status-1">Current status</a></h2>
<p>The V2 interface is currently <strong>available but not the default</strong>. It can be
activated as described below.</p>
<h2><a class="header" href="#activating-the-v2-interface" id="activating-the-v2-interface">Activating the V2 Interface</a></h2>
<p>Because the V2 interface is not the current default, it must be explicitly
activated. There are several ways to do this. One way is to use <code>-X</code> for the
very first command-line argument to the <code>tectonic</code> executable, like so:</p>
<pre><code class="language-sh">tectonic -X build
</code></pre>
<p>It is anticipated that this form of invocation will be supported indefinitely.</p>
<p>Alternatively, if the Tectonic executable is run under a name containing the
string <code>nextonic</code>, the V2 interface will also be enabled. In this case, no <code>-X</code>
is needed (or allowed, at the moment):</p>
<pre><code class="language-sh">nextonic build
</code></pre>
<p>You can use various Unix <code>argv[0]</code> hacks to achieve this, or you can just rename
or symlink the <code>tectonic</code> binary to <code>nextonic</code> manually.</p>
<h2><a class="header" href="#external-tools" id="external-tools">External tools</a></h2>
<p>The V2 interface also supports external commands. If you run <code>tectonic -X cmd</code>, where <code>cmd</code> is NOT built into Tectonic, Tectonic will search for a binary called <code>tectonic-cmd</code> and run it if it exists.</p>
<h2><a class="header" href="#migration-plan" id="migration-plan">Migration plan</a></h2>
<p>The plan is to eventually migrate to make the V2 interface the default. This
will be implemented as follows:</p>
<ol>
<li>Under the current situation, the V2 interface can be explicitly activated
with the leading <code>-X</code> flag. The V1 interface can be explicitly selected by
using a leading <code>-Y</code> flag. The default is V1.</li>
<li>Once the V2 interface is sufficiently stable, the V1 UI will start
recommending that people adopt it via the <code>-X</code> flag. Users that want to keep
using the V1 interface will be instructed to explicitly select it with the
<code>-Y</code> option.</li>
<li>After a sufficient amount of time, the V1 interface will be flagged as
deprecated.</li>
<li>After more time has passed, the default will flip: if neither <code>-X</code> nor <code>-Y</code>
is provided, the V2 interface will be assumed rather than V1.</li>
<li>Eventually, the V1 interface may be entirely removed.</li>
</ol>
<h1><a class="header" href="#workspaces" id="workspaces">Workspaces</a></h1>
<p><em><strong>This concept only applies to Tectonic’s <a href="ref/./v2cli.html">V2 interface</a>. It is not
relevant to <a href="ref/./v1cli.html">the original (“V1”) interface</a>.</strong></em></p>
<p>A Tectonic <em>workspace</em> is a directory tree for building documents. The top-level
directory of a workspace contains a <a href="ref/./tectonic-toml.html">Tectonic.toml</a> file.</p>
<p>At the moment, a workspace contains exactly one <a href="ref/./documents.html">document</a>, having its source
rooted in the workspace root. In the future, Tectonic may be extended so that a
workspace might contain more than one document.</p>
<h1><a class="header" href="#how-to-install-tectonic" id="how-to-install-tectonic">How To: Install Tectonic</a></h1>
<p>One of the big advantages that Tectonic offers compared to the traditional TeX
stack is that all of Tectonic’s functionality is delivered in a single
executable file — not the usual tree of thousands of interlocking data files and
binary tools.</p>
<p>You have several options for obtaining the Tectonic executable. The best choice
depends on your computing environment and your needs.</p>
<ul>
<li><strong>For the fastest and easiest installation, <a href="installation/index.html#copy-paste-a-terminal-command">copy-paste a command into your
terminal</a></strong> that will automatically download
the right Tectonic program for your computer</li>
<li><a href="installation/index.html#direct-download">Direct download</a> a Tectonic release</li>
<li><a href="installation/index.html#pre-built-binary-packages">Pre-built binary packages</a> for your favorite
operating system or package manager</li>
<li><a href="installation/index.html#compile-tectonic-yourself">Compile it yourself</a></li>
</ul>
<p>The <a href="installation/index.html#copy-paste-a-terminal-command">copy-paste method</a> should cover most use
cases, but if you want better integration with your operating system or
computing environment, <a href="installation/index.html#pre-built-binary-packages">packaged versions</a> might
make more sense. There should be no need to compile Tectonic yourself unless you
want to, or you’re hoping to run it on an unusual platform.</p>
<h2><a class="header" href="#copy-paste-a-terminal-command" id="copy-paste-a-terminal-command">Copy-paste a terminal command</a></h2>
<p>This is generally the easiest way to get Tectonic onto your computer. On a
computer running a Unix-like operating system, including macOS, just run the
following command in your terminal:</p>
<pre><code class="language-sh">curl --proto '=https' --tlsv1.2 -fsSL https://drop-sh.fullyjustified.net |sh
</code></pre>
<p>This will download the <code>tectonic</code> program and place it into the directory where
you ran the command.</p>
<p>On Windows, you can do the same in a PowerShell window, which will unpack
<code>tectonic.exe</code> for you:</p>
<pre><code class="language-ps1">[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://drop-ps1.fullyjustified.net'))
</code></pre>
<p>No matter your operating system, you should probably move the unpacked file into
a directory in your executable search path so that you can run Tectonic from any
working directory. For the time being, the download script doesn’t do this
because it can be tricky to automatically determine what the best installation
destination would be.</p>
<h2><a class="header" href="#direct-download" id="direct-download">Direct download</a></h2>
<p>You can <a href="https://tectonic-typesetting.github.io/latest.html">download the latest release of Tectonic here</a> on GitHub. Each
release is published with precompiled executables attached. Because Tectonic is
distributed as a single executable, all you need to do is download the
appropriate archive for your platform and unpack it.</p>
<p>For instance, on most Linux systems, you’ll want to download the file with the
name looking like <code>tectonic-&lt;VERSION&gt;-x86_64-unknown-linux-gnu.tar.gz</code>. This
tarball will unpack to a single file, <code>tectonic</code>, which is the Tectonic
executable.</p>
<h2><a class="header" href="#pre-built-binary-packages" id="pre-built-binary-packages">Pre-built binary packages</a></h2>
<p>Tectonic may be available in precompiled packages offered by either your
operating system or standalone package managers. Check out <a href="https://github.com/tectonic-typesetting/tectonic/#readme">the Tectonic source
repository</a> for an up-to-date listing.</p>
<p>In most cases, the package name will be <code>tectonic</code> and will provide a
command-line tool also named <code>tectonic</code>.</p>
<h3><a class="header" href="#pre-built-packages-for-anaconda" id="pre-built-packages-for-anaconda">Pre-built packages for (Ana)conda</a></h3>
<p>Tectonic is available for the <a href="https://docs.conda.io/">Conda package manager</a>, which has the
advantages of (1) not requiring any administrator privileges and (2) supporting
Windows, macOS, and Linux. If you’d like to install Tectonic using a package
manager and you’re not aware of a different option that’s a better fit for your
needs, we recommend using Conda.</p>
<p>If you don’t already have Conda installed, we recommend that you <a href="https://docs.conda.io/en/latest/miniconda.html">install the
“Miniconda” package</a> provided by <a href="https://www.anaconda.com/">Anaconda, Inc.</a>. Once
complete, the command <code>conda</code> will now be available in your terminal.</p>
<p>Once the <code>conda</code> command is available, you can install Tectonic and its support
libraries using <a href="http://conda-forge.github.io/">conda-forge</a>, a community-led
Conda packaging project. To install Tectonic you must activate conda-forge,
which can be done temporarily like so:</p>
<pre><code class="language-sh">$ conda install -c conda-forge tectonic
</code></pre>
<h3><a class="header" href="#arch-linux" id="arch-linux">Arch Linux</a></h3>
<p>For users of <a href="https://archlinux.org/">Arch Linux</a>, there are two Tectonic packages available: <a href="https://archlinux.org/packages/extra/x86_64/tectonic/">tectonic</a> from the official repositories, which can be installed with</p>
<pre><code class="language-sh">$ sudo pacman -S tectonic
</code></pre>
<p>and <a href="https://aur.archlinux.org/packages/tectonic-git">tectonic-git</a> from the <a href="https://aur.archlinux.org/">AUR</a>.</p>
<h3><a class="header" href="#homebrew" id="homebrew">Homebrew</a></h3>
<p>There is a <code>tectonic</code> package in <a href="https://brew.sh/">Homebrew</a>. If you already
have Homebrew installed, installing Tectonic should be as simple as:</p>
<pre><code class="language-sh">$ brew install tectonic
</code></pre>
<p>We also have instructions about <a href="installation//howto/build-tectonic/external-dep-install.html#homebrew-on-macos">installing Tectonic’s dependencies using
Homebrew</a> if you’d like to compile Tectonic yourself on your
Homebrew-based computer.</p>
<h3><a class="header" href="#macports" id="macports">MacPorts</a></h3>
<p>There is a <code>tectonic</code> port in <a href="https://www.macports.org/">MacPorts</a>. If you
already have MacPorts installed, installing Tectonic should be as simple as:</p>
<pre><code class="language-sh">$ sudo port install tectonic
</code></pre>
<h3><a class="header" href="#nix-or-nixos" id="nix-or-nixos">nix or nixOS</a></h3>
<p>If you’re using <a href="https://nixos.org/">nix</a>, you can imperatively install <a href="https://nixos.org/nixos/packages.html#tectonic"><code>tectonic</code></a> with:</p>
<pre><code class="language-sh">$ nix-env -f '&lt;nixpkgs&gt;' -iA tectonic
</code></pre>
<p>in your shell. You can also create a temporary environment using
<a href="https://nixos.org/nix/manual/#sec-nix-shell"><code>nix-shell</code></a>:</p>
<pre><code class="language-sh">$ nix-shell '&lt;nixpkgs&gt;' -A tectonic
</code></pre>
<h3><a class="header" href="#void-linux" id="void-linux">Void Linux</a></h3>
<p>Void Linux has a <code>tectonic</code> package in the <a href="https://github.com/void-linux/void-packages/blob/master/srcpkgs/tectonic/template">void-packages</a> repository. To
install it, run:</p>
<pre><code class="language-sh">$ sudo xbps-install -S tectonic
</code></pre>
<h2><a class="header" href="#compile-tectonic-yourself" id="compile-tectonic-yourself">Compile Tectonic Yourself</a></h2>
<p>You can always compile Tectonic yourself. If your system has C++ and Rust
compilers installed, this may be as simple as running:</p>
<pre><code class="language-sh">$ cargo install tectonic
</code></pre>
<p>However, Tectonic requires various C/C++ support libraries that may not be
available on your system by default. There are also various build options that
you can turn on and off if you have more specialized needs. For all the details,
consult the <a href="installation/../howto/build-tectonic/index.html">How To Build Tectonic</a> guide.</p>
<h1><a class="header" href="#how-to-build-tectonic" id="how-to-build-tectonic">How To: Build Tectonic</a></h1>
<p>This document lays out the options available for building the Tectonic <a href="https://doc.rust-lang.org/rust-by-example/crates.html">Rust
crate</a> and/or <a href="https://en.wikipedia.org/wiki/Executable">executable</a> from source code. Because Tectonic relies
on a large number of system libraries and tightly-integrated C/C++ code, it can
be more challenging to compile than most Rust code.</p>
<p>For this reason, if you just want to <em>run</em> Tectonic, we recommend that you start
by <a href="howto/build-tectonic/../installation/index.html">installing</a> a pre-built version if possible. Using a pre-compiled
binary will save you time and, possibly, headaches.</p>
<h2><a class="header" href="#basic-prerequisites" id="basic-prerequisites">Basic Prerequisites</a></h2>
<p>To build Tectonic you will need Rust, C, and C++ compilers installed. It is
beyond the scope of this document to give instructions on this topic, besides
pointing you to the <a href="https://www.rust-lang.org/tools/install">Rust installation
page</a>.</p>
<p>You do <em>not</em> necessarily need to download a copy of the Tectonic source code, if
the <a href="https://doc.rust-lang.org/cargo/commands/cargo-install.html">cargo install</a> command will meet your needs.</p>
<h2><a class="header" href="#third-party-dependencies" id="third-party-dependencies">Third-Party Dependencies</a></h2>
<p>Tectonic relies on a number of well-established third-party libraries that deal
with fonts, Unicode, text shaping, and so on. Specifically:</p>
<ul>
<li><a href="https://fontconfig.org/">fontconfig</a> for discovering system fonts (except on
macOS)</li>
<li><a href="https://www.freetype.org/">freetype2</a> for parsing font files</li>
<li><a href="https://graphite.sil.org/">graphite2</a> for shaping certain unusual scripts</li>
<li><a href="https://harfbuzz.github.io/">Harfbuzz</a> for text shaping</li>
<li><a href="http://site.icu-project.org/home">ICU4C</a> for Unicode data and algorithms</li>
<li><a href="http://www.libpng.org/">libpng</a> for parsing PNG images</li>
<li><a href="https://www.openssl.org/">OpenSSL</a> for HTTPS if you’re not on a Mac or
Windows machine (or whichever SSL library is required for your system by the
<a href="https://github.com/sfackler/rust-native-tls/#readme">rust-native-tls</a> crate)</li>
<li><a href="https://zlib.net/">zlib</a> for compression algorithms</li>
</ul>
<p>To build Tectonic, your first task is to decide where you want these library
dependencies to come from.</p>
<ul>
<li>Tectonic can provide some dependencies <strong>internally</strong> (“vendor” them). This is
the default for <a href="https://harfbuzz.github.io/">Harfbuzz</a>. You can use <a href="https://doc.rust-lang.org/cargo/reference/features.html">Cargo features</a>,
described below, to control when this happens. For some third-party libraries
needed by Tectonic, vendoring is not possible.</li>
<li>You can install the dependencies <strong>externally</strong>, with a system such as your
OS’s package manager, and tell the Tectonic build system how to access them.
Read <a href="howto/build-tectonic/./external-dep-install.html">how to install Tectonic’s dependencies externally</a>
for quick recipes as to how to do that.</li>
<li>As an intermediate approach, you can <strong>use cargo-vcpkg</strong> to compile the
dependencies for Tectonic’s use with <a href="https://vcpkg.readthedocs.io">vcpkg</a>. Read <a href="howto/build-tectonic/./cargo-vcpkg-dep-install.html">this
page</a> to learn how to do that.</li>
</ul>
<p>You’ll have to set up one of two ways for the Tectonic build system to gather
the appropriate information about how to compile against the external
dependencies:</p>
<ul>
<li><strong><a href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a></strong>, the default system, is the appropriate choice in most cases.
Generally all you need to do is make sure that the <code>pkg-config</code> program is
installed using the same framework as you used to install the library
dependencies. You can force the Tectonic build system to use pkg-config for
dependency discovery by setting the environment variable
<code>TECTONIC_DEP_BACKEND</code> to the value <code>pkg-config</code>.</li>
<li><strong><a href="https://vcpkg.readthedocs.io">vcpkg</a></strong> is the choice to use if you installed your dependencies this way,
either <a href="howto/build-tectonic/./cargo-vcpkg-dep-install.html">using cargo-vcpkg</a> or separately. Activate
this mode by setting the environment variable <code>TECTONIC_DEP_BACKEND</code> to the
value <code>vcpkg</code>.</li>
</ul>
<p>If using <a href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a>, setting the environment variable
<code>TECTONIC_PKGCONFIG_FORCE_SEMI_STATIC</code> will cause the build system to attempt to
link with external libraries statically rather than dynamically. System
libraries, such as <code>libc</code> and <code>libm</code> on Unix systems, will still be linked
dynamically. This mode is planned to be superseded by better support for
“vendoring” dependent libraries.</p>
<h2><a class="header" href="#choose-cargo-features" id="choose-cargo-features">Choose Cargo Features</a></h2>
<p>The Cargo build framework offers the concept of <a href="https://doc.rust-lang.org/cargo/reference/features.html">features</a> to
control build options. Tectonic offers the following features:</p>
<ul>
<li><strong><code>external-harfbuzz</code></strong>. By default, the Tectonic crates will build and link
to a “vendored” (static, internal) version of the <a href="https://harfbuzz.github.io/">Harfbuzz</a> text shaping
library. If you would like to link to an externally-supplied version instead,
enable this feature.</li>
<li><strong><code>geturl-curl</code></strong>. Uses the <a href="https://docs.rs/curl/">curl</a> crate to get URLs. In order for this to
take effect, you must use <code>--no-default-features</code>, because <code>geturl-reqwest</code> is
a default feature and takes precedence.</li>
<li><strong><code>geturl-reqwest</code></strong> (enabled by default). Uses the <a href="https://docs.rs/reqwest/">reqwest</a> crate to get
URLs. This is a good portable default.</li>
<li><strong><code>native-tls-vendored</code></strong>. If using <a href="https://docs.rs/reqwest/">reqwest</a>, activate the <code>vendored</code> option
in the <a href="https://github.com/sfackler/rust-native-tls">native-tls</a> crate, causing OpenSSL to be vendored. This can be useful
when cross-compiling or building static binaries, but is discouraged because
that means that the resulting binaries won’t benefit from security fixes to
system TLS libraries.</li>
</ul>
<p>Some lesser-used features are:</p>
<ul>
<li><strong><code>serialization</code></strong> (enabled by default). Disabling this feature turns off all
Tectonic features that require the <a href="https://crates.io/crates/serde">serde</a> crate. This option is provided
because Tectonic’s use of serde requires <a href="https://doc.rust-lang.org/reference/procedural-macros.html">procedural macro</a>
support, which is not available by default on static-only compilation
environments. However, it is likely that serialization support will become
mandatory in the future, and one can still produce static <code>tectonic</code>
executables using a cross-compilation approach. Therefore we do not recommend
that you rely on this feature.</li>
<li><strong><code>profile</code></strong>. Compile Tectonic code in such a way as to make it profileable.
In particular, this forces the C/C++ compiler to include frame pointer
information unless it is known that such information is not needed for
profiling on the target platform.</li>
</ul>
<p>To avoid activating a feature that is enabled by default, you must pass the
<code>--no-default-features</code> flag to the <code>cargo</code> command that you run. Features are
enabled with a flag such as <code>--features &quot;serialization profile&quot;</code>.</p>
<h2><a class="header" href="#compile-the-code" id="compile-the-code">Compile the Code</a></h2>
<p>To build the latest released version of Tectonic without needing to download its
source code, first <em>ensure that your build environment variables are set up
properly</em> and determine what feature flags you need. Then run:</p>
<pre><code class="language-sh">cargo install tectonic
</code></pre>
<p>inserting any feature flags after the <code>install</code>. To install the latest version
from Git, do the same but use:</p>
<pre><code class="language-sh">cargo install --git https://github.com/tectonic-typesetting/tectonic.git
</code></pre>
<p>Many other variations are possible. See the <a href="https://doc.rust-lang.org/cargo/commands/cargo-install.html">cargo install</a> documentation for
more.</p>
<p>If you have downloaded its source code (perhaps because you wish to make your
own improvements), make sure that you’re inside the Tectonic source tree and run:</p>
<pre><code class="language-sh">cargo build
</code></pre>
<p>once again adding any feature flags and ensuring that any necessary build
environment variables are set up properly. Read <a href="https://doc.rust-lang.org/cargo/index.html">The Cargo Book</a> for
vastly more information about where you can go from there.</p>
<h1><a class="header" href="#how-to-build-tectonic-install-system-dependencies" id="how-to-build-tectonic-install-system-dependencies">How To: Build Tectonic: Install System Dependencies</a></h1>
<p>Here are quick commands to install Tectonic’s dependencies using various package
managers:</p>
<ul>
<li><a href="howto/build-tectonic/external-dep-install.html#debian-and-ubuntu-linux">Debian and Ubuntu Linux</a> and related variants</li>
<li><a href="howto/build-tectonic/external-dep-install.html#rhel-centos-and-fedora-linux">RHEL, CentOS, and Fedora Linux</a> and related variants</li>
<li><a href="howto/build-tectonic/external-dep-install.html#homebrew-on-macos">Homebrew on macOS</a></li>
<li><a href="howto/build-tectonic/external-dep-install.html#conda">conda</a> on various operating systems</li>
<li><a href="howto/build-tectonic/external-dep-install.html#vcpkg">vcpkg</a> on various operating systems (including Windows)</li>
</ul>
<p>If none of these fit your needs, you’ll need to figure out the right packages
for your particular setup. Tectonic requires the following libraries:</p>
<ul>
<li><a href="https://fontconfig.org/">fontconfig</a> (except on macOS)</li>
<li><a href="https://www.freetype.org/">freetype2</a></li>
<li><a href="https://graphite.sil.org/">graphite2</a></li>
<li><a href="https://harfbuzz.github.io/">harfbuzz</a></li>
<li><a href="http://site.icu-project.org/home">ICU4C</a></li>
<li><a href="http://www.libpng.org/">libpng</a></li>
<li><a href="https://zlib.net/">zlib</a></li>
<li>Whichever SSL library is required for your system by the <a href="https://github.com/sfackler/rust-native-tls/#readme">rust-native-tls</a>
crate: probably <a href="https://www.openssl.org/">OpenSSL</a></li>
</ul>
<h2><a class="header" href="#debian-and-ubuntu-linux" id="debian-and-ubuntu-linux">Debian and Ubuntu Linux</a></h2>
<p>Install Tectonic’s dependencies with:</p>
<pre><code class="language-sh">sudo apt-get install \
  libfontconfig1-dev libgraphite2-dev libharfbuzz-dev libicu-dev libssl-dev zlib1g-dev
</code></pre>
<h2><a class="header" href="#rhel-centos-and-fedora-linux" id="rhel-centos-and-fedora-linux">RHEL, CentOS, and Fedora Linux</a></h2>
<p>Install Tectonic’s dependencies with:</p>
<pre><code class="language-sh">sudo dnf install \
  gcc-c++ fontconfig-devel graphite2-devel harfbuzz-devel libicu-devel openssl-devel zlib-devel
</code></pre>
<h2><a class="header" href="#homebrew-on-macos" id="homebrew-on-macos">Homebrew on macOS</a></h2>
<p>If you use <a href="https://brew.sh">Homebrew</a>, be aware that you can install Tectonic with it directly!</p>
<pre><code class="language-sh">brew install tectonic
</code></pre>
<p>If you want to compile Tectonic yourself, the following command will install the
dependencies:</p>
<pre><code class="language-sh">brew install --only-dependencies tectonic
</code></pre>
<p>You will also need to make sure that your environment has <a href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a> set up to
find the Homebrew libraries correctly.</p>
<h2><a class="header" href="#conda" id="conda">Conda</a></h2>
<p>If you use <a href="https://docs.conda.io/">Conda</a>, be aware that you can install Tectonic with it directly,
using the <a href="https://conda-forge.org/">conda-forge</a> channel!</p>
<pre><code class="language-sh">conda install -c conda-forge tectonic
</code></pre>
<p>But if you want to compile Tectonic yourself, the following command will install
the dependencies:</p>
<pre><code class="language-sh">conda install fontconfig freetype graphite2 harfbuzz icu libpng openssl zlib
</code></pre>
<p>You will also need to make sure that your environment has <a href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a> set up to
find the Conda libraries correctly.</p>
<h2><a class="header" href="#vcpkg" id="vcpkg">vcpkg</a></h2>
<p>If you wish to use <a href="https://vcpkg.readthedocs.io/">vcpkg</a> to provide Tectonic’s build dependencies, we
recommend that you use <a href="howto/build-tectonic/./cargo-vcpkg-dep-install.html">the cargo-vcpkg tool</a>. But
for the record, to install Tectonic’s dependencies through vcpkg directly, you
should probably run:</p>
<pre><code class="language-sh">vcpkg install fontconfig freetype &quot;harfbuzz[graphite2]&quot; icu
</code></pre>
<h1><a class="header" href="#how-to-build-tectonic-install-dependencies-with-cargo-vcpkg" id="how-to-build-tectonic-install-dependencies-with-cargo-vcpkg">How To: Build Tectonic: Install Dependencies With cargo-vcpkg</a></h1>
<p>A convenient, fairly cross-platform way to install Tectonic’s dependencies is
using the <a href="https://crates.io/crates/cargo-vcpkg">cargo-vcpkg</a> tool. It will take care of setting up <a href="https://vcpkg.readthedocs.io/">vcpkg</a>, providing
the needed dependencies, and informing Tectonic’s build system about how to find
them. It will, however, generally require that the dependencies be compiled from
scratch.</p>
<p>First, install <a href="https://crates.io/crates/cargo-vcpkg">cargo-vcpkg</a> if needed:</p>
<pre><code class="language-sh">cargo install cargo-vcpkg
</code></pre>
<p>Then, in the Tectonic source tree, run the command to obtain all of the needed
dependencies:</p>
<pre><code class="language-sh">cargo vcpkg build
</code></pre>
<p>Then set the <code>VCPKG_ROOT</code> environment variable to tell the build system where
the dependencies may be found. In a <a href="https://www.gnu.org/software/bash/">bash</a> shell, a good command is:</p>
<pre><code class="language-sh">export VCPKG_ROOT=&quot;${CARGO_TARGET_DIR:-$(pwd)/target}/vcpkg&quot;
</code></pre>
<p>If you’re building on Windows, you’ll likely want to make sure that your
<a href="https://doc.rust-lang.org/cargo/reference/environment-variables.html"><code>RUSTFLAGS</code></a> variable includes a <code>+crt-static</code> <a href="https://rust-lang.github.io/packed_simd/perf-guide/target-feature/rustflags.html">target feature</a> and set the
<code>VCPKGRS_TRIPLET</code> variable to <code>x64-windows-static-release</code>. This is a custom
<a href="https://vcpkg.readthedocs.io/en/latest/users/triplets/">vcpkg triplet</a> provided by Tectonic’s build system (in the directory
<code>dist/vcpkg-triplets</code>) that is automatically activated by its <a href="https://crates.io/crates/cargo-vcpkg">cargo-vcpkg</a>
integration. If you don’t use <a href="https://crates.io/crates/cargo-vcpkg">cargo-vcpkg</a>, the default triplet is
<code>x64-windows-static</code> if the <code>+crt-static</code> feature is activated, or
<code>x64-windows-static-md</code> if it is not.</p>
<p>If you’ve done the full vcpkg install, you might as well build with <a href="howto/build-tectonic/./index.html#choose-cargo-features">an external
Harfbuzz</a>. Therefore a full Windows build invocation —
launched from bash — might look like this:</p>
<pre><code class="language-sh">cargo vcpkg build
export VCPKG_ROOT=&quot;${CARGO_TARGET_DIR:-$(pwd)/target}/vcpkg&quot;
export RUSTFLAGS='-Ctarget-feature=+crt-static'  # Windows only
export VCPKGRS_TRIPLET='x64-windows-static-release'  # Windows only
export TECTONIC_DEP_BACKEND=vcpkg
cargo build --features external-harfbuzz
</code></pre>
<p>Note that if you are going to run additional commands such as <code>cargo test</code>,
you’re going to need to ensure that the same environment variables <em>and feature
flags</em> are used consistently.</p>
<h1><a class="header" href="#how-to-use-tectonic-with-auctex" id="how-to-use-tectonic-with-auctex">How To: Use Tectonic with AucTeX</a></h1>
<p>This section is a guide aimed at <a href="https://www.gnu.org/software/emacs/">GNU
Emacs</a> users for setting up
<a href="https://www.gnu.org/software/auctex/">AucTeX</a> with Tectonic as the TeX/LaTeX
distribution.</p>
<h2><a class="header" href="#basic-prerequisites-1" id="basic-prerequisites-1">Basic Prerequisites</a></h2>
<p>To follow this section you will need Tectonic and GNU Emacs installed on your
system. Additionally, you will require the AucTeX emacs package to be installed
before following along.</p>
<blockquote>
<p>Note: This section makes use of the <a href="howto/auctex-setup/../../ref/v2cli.html">V2 tectonic CLI</a>,
invoked using the <code>tectonic -X</code> flag or <code>nextonic</code> command alias.</p>
</blockquote>
<h2><a class="header" href="#setup" id="setup">Setup</a></h2>
<p>All the code displayed in this section should go into your <code>init.el</code> file (or
equivalent, such as <code>config.el</code> if you are using
<a href="https://github.com/doomemacs/">Doomemacs</a>).</p>
<p>First, load the AucTeX package.</p>
<pre><code class="language-lisp">(require 'latex)
</code></pre>
<p>You will need to set the default TeX engine AucTeX uses to figure out the build
commands to use Tectonic instead of traditional TeX distributions. Therefore we
have to modify the <code>TeX-engine-alist</code> variable.</p>
<ul>
<li>The first element of the list is the symbol that AucTeX recognizes.</li>
<li>The second element is a string with the name of the TeX distribution.</li>
<li>The third element is the shell command for compiling plain TeX documents.</li>
<li>The fourth element is the shell command for compiling LaTeX documents. Here we
are assuming the user is using a Tectonic project (generated using <code>tectonic -X new &lt;proj-name&gt;</code>).</li>
<li>The last element is the shell command for compiling ConTeXt documents, left
unconfigured for now.</li>
</ul>
<pre><code class="language-lisp">(setq TeX-engine-alist '((default
                          &quot;Tectonic&quot;
                          &quot;tectonic -X compile -f plain %T&quot;
                          &quot;tectonic -X watch&quot;
                          nil)))
</code></pre>
<p>Next, modify the <code>LaTeX-command-style</code> so that AucTex doesn’t add extra options
to it that Tectonic does not recognize. We simply set it to the <code>%(latex)</code>
expansion (from <code>TeX-expand-list-builtin</code>), removing any other extra options.</p>
<pre><code class="language-lisp">(setq LaTeX-command-style '((&quot;&quot; &quot;%(latex)&quot;)))
</code></pre>
<p>We need to set the <code>TeX-check-TeX</code> variable to <code>nil</code> since AucTeX will try to
find a traditional distribution like <code>TeXLive</code> or others, and will fail since
Tectonic doesn’t meet its criteria.</p>
<p>Additionally, we should also set <code>TeX-process-asynchronous</code> to <code>t</code>, so that
running Tectonic in watch mode doesn’t hang up Emacs.</p>
<p>We’ll also just ensure that the <code>TeX-engine</code> is set to <code>default</code>.</p>
<pre><code class="language-lisp">(setq TeX-process-asynchronous t
      TeX-check-TeX nil
      TeX-engine 'default)
</code></pre>
<p>Finally, modify the <code>TeX-command-list</code> to use the appropriate commands and not
pass in extra metadata and options to Tectonic that cause it to error out. This
needs to be done in place.</p>
<pre><code class="language-lisp">(let ((tex-list (assoc &quot;TeX&quot; TeX-command-list))
      (latex-list (assoc &quot;LaTeX&quot; TeX-command-list)))
  (setf (cadr tex-list) &quot;%(tex)&quot;
        (cadr latex-list) &quot;%l&quot;))
</code></pre>
<p>And that is all! You should now be able to</p>
<ol>
<li>Compile plain TeX files.</li>
<li>Build Tectonic LaTeX projects in watch mode.</li>
</ol>
<h2><a class="header" href="#additional-configuration-and-usage-suggestions" id="additional-configuration-and-usage-suggestions">Additional Configuration and Usage Suggestions</a></h2>
<h3><a class="header" href="#compile-latex-outside-a-tectonic-project" id="compile-latex-outside-a-tectonic-project">Compile LaTeX outside a Tectonic project</a></h3>
<p>To do this, you can simply invoke <code>M-x TeX-command-master</code> and select the
<code>Other</code> option, passing in the compile command <code>tectonic -X compile -f latex &lt;name of file&gt;</code>.</p>
<blockquote>
<p><strong>Caution</strong>: Compiling a document with multiple LaTeX files in this manner
isn’t extensively tested, as using a Tectonic project is the better way in
that case. Any bug reports are welcome.</p>
</blockquote>
<h3><a class="header" href="#live-pdf-preview-in-tectonic-projects" id="live-pdf-preview-in-tectonic-projects">Live PDF Preview in Tectonic projects</a></h3>
<p>AucTeX expects the output PDF after compiling to be in the same directory as the
input file. So it will error out when that is not the case, since Tectonic
places the output in a build directory.</p>
<p>This behavior can be controlled by using the <code>TeX-output-dir</code> variable on a per
project basis.</p>
<p>This configuration assumes you are using <code>project.el</code>, although porting this
code to <code>projectile.el</code> should be trivial.</p>
<pre><code class="language-lisp">(add-hook 'after-change-major-mode-hook
          (lambda ()
            (when-let ((project (project-current))
                       (proot (project-root project)))
              (when (file-exists-p (expand-file-name &quot;Tectonic.toml&quot; proot))
                (setq-local TeX-output-dir (expand-file-name &quot;build/index&quot; proot))))))
</code></pre>
<p>We are basically looking for <code>Tectonic.toml</code> file in the project root, and if it
exists, setting the <code>TeX-output-dir</code> to the appropriate path to the build
directory. You may replace the <code>&quot;build/index&quot;</code> path with wherever your PDF file
is placed after it is generated by Tectonic.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
